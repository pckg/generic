<div class="pageStructure">
    <script type="text/javascript">
        var data = {
            variables: {{ variables.toJSON() | raw }},
            route: {{ route.toJSON() | raw }},
            layout: {{ layout.toJSON() | raw }},
            formActionMorph: {{ actionsMorph.toJSON() | raw }}
        };
        var routeActions = new Vue({
            el: '.pageStructure',
            data: function () {
                return {
                    variables: data.variables,
                    route: data.route,
                    layout: data.layout
                };
            },
            methods: {
                addAction: function () {
                    $('#pageStructureModal').modal('show');
                }
            }
        });
    </script>
    {% embed 'Pckg/Generic/View/modal.twig' with {'close': true} %}
        {% block header %}
            Add action morph
        {% endblock %}
        {% block body %}
            {{ actionMorphForm | raw }}
        {% endblock %}
    {% endembed %}

    <div class="list-group" v-for="variable in variables">
        {% embed 'Pckg/Generic/View/panel.twig' %}
            {% block title %}
                Variable: {% verbatim %}{{ variable.slug }}{% endverbatim %}
            {% endblock %}
            {% block content %}
                <a href="#" class="list-group-item" v-for="actionMorph in route.actionsMorphs"
                   v-if="actionMorph.variable_id == variable.id">
                    <h4 class="list-group-item-heading">1 Action: {{ actionMorph.action.slug }}</h4>
                    <p>Order: {% verbatim %}{{ actionMorph.order }}{% endverbatim %}</p>
                    <p class="list-group-item-text" v-if="actionMorph.content_id">
                        Content: {% verbatim %}{{ actionMorph.content_id }}{% endverbatim %}
                    </p>
                </a>
                <a href="#" class="list-group-item" v-for="actionMorph in layout.actionsMorphs"
                   v-if="actionMorph.variable_id == variable.id">
                    <h4 class="list-group-item-heading">2 Layout action: {{ actionMorph.action.slug }}</h4>
                    <p>Order: {% verbatim %}{{ actionMorph.order }}{% endverbatim %}</p>
                    <p class="list-group-item-text" v-if="actionMorph.content_id">
                        Content: {% verbatim %}{{ actionMorph.content_id }}{% endverbatim %}
                    </p>
                </a>
                <a href="#" class="list-group-item">
                    <h4 class="list-group-item-heading" v-on:click="addAction">New action</h4>
                </a>
            {% endblock %}
        {% endembed %}
    </div>
    {% embed 'Pckg/Generic/View/panel.twig' %}
        {% block title %}
            No variable
        {% endblock %}
        {% block content %}
            <a href="#" class="list-group-item" v-for="actionMorph in route.actionsMorphs"
               v-if="!actionMorph.variable_id">
                <h4 class="list-group-item-heading">3 Action: {{ actionMorph.action.slug }}</h4>
                <p>Order: {% verbatim %}{{ actionMorph.order }}{% endverbatim %}</p>
                <p class="list-group-item-text" v-if="actionMorph.content_id">
                    Content: {% verbatim %}{{ actionMorph.content_id }}{% endverbatim %}
                </p>
            </a>
            <a href="#" class="list-group-item" v-for="actionMorph in layout.actionsMorphs"
               v-if="!actionMorph.variable_id">
                <h4 class="list-group-item-heading">4 Layout action: {{ actionMorph.action.slug }}</h4>
                <p>Order: {% verbatim %}{{ actionMorph.order }}{% endverbatim %}</p>
                <p class="list-group-item-text" v-if="actionMorph.content_id">
                    Content: {% verbatim %}{{ actionMorph.content_id }}{% endverbatim %}
                </p>
            </a>
            <a href="#" class="list-group-item">
                <h4 class="list-group-item-heading" v-on:click="addAction">New action</h4>
            </a>
        {% endblock %}
    {% endembed %}
</div>