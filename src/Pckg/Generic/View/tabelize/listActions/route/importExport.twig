<script type="text/x-template" id="pckg-generic-routes-importexport">
</script>

<script type="text/javascript">
    Vue.component('pckg-generic-routes-importexport', {
        mixins: [pckgDelimiters],
        name: 'pckg-generic-routes-importexport',
        template: '#pckg-generic-routes-importexport',
        data: function () {
            return {
                record: {},
                structure: ''
            };
        },
        methods: {
            exportRoute: function () {
                http.getJSON(utils.url('{{ url('pckg.generic.pageStructure.routeExport') }}', {route: this.record.id}), function (data) {
                    this.structure = JSON.stringify(data.export);
                    $dispatcher.$emit('notification:success', 'Route exported');
                }.bind(this));
            },
            importRoute: function () {
                http.post(utils.url('{{ url('pckg.generic.pageStructure.routeImport') }}', {route: this.record.id}), {'export': this.structure}, function (data) {
                    $dispatcher.$emit('notification:success', 'Route imported');
                }.bind(this));
            },
            importExport: function (record) {
                this.record = record;

                $('#importExportModal').modal('show');
            }
        },
        created: function () {
            $dispatcher.$on('record:importExport', this.importExport);
        },
        beforeDestroy: function () {
            $dispatcher.$off('record:importExport', this.importExport);
        }
    });
</script>

<pckg-generic-routes-importexport></pckg-generic-routes-importexport>